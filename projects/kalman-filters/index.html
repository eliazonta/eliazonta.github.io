<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Kalman Filters | Elia Zonta </title> <meta name="author" content="Elia Zonta"> <meta name="description" content="A gentle introduction to Kalman filters and a simple application"> <meta name="keywords" content="zonta, eliazonta"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8C%8A&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://eliazonta.github.io/projects/kalman-filters/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Kalman Filters",
            "description": "A gentle introduction to Kalman filters and a simple application",
            "published": "April 15, 2025",
            "authors": [
              
              {
                "author": "Elia Zonta",
                "authorURL": "",
                "affiliations": [
                  {
                    "name": "DISMA, Politecnico di Torino",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Elia</span> Zonta </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/books/">bookshelf</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Kalman Filters</h1> <p>A gentle introduction to Kalman filters and a simple application</p> </d-title> <d-byline></d-byline> <d-article> <h3 id="abstract">Abstract:</h3> <p>This small paper presents a compact overview of the Kalman Filter, a recursive solution to the linear filtering problem. Widely used in control systems and signal processing, the Kalman Filter also has compelling applications in financial modeling. We provide a brief mathematical formulation followed by a Python-based example in the financial domain.</p> <p>⸻</p> <h3 id="introduction">Introduction</h3> <p>The Kalman Filter is an efficient recursive estimator that computes the state of a linear dynamic system from a series of noisy measurements <d-cite key="kalman1960new"></d-cite><d-cite key="kalman1963mathematical"></d-cite>. Originally developed for aerospace navigation, its robustness and adaptability have made it a staple in diverse fields such as robotics, economics, and finance.</p> <p>In financial systems, the Kalman Filter can be employed to estimate <strong>latent variables</strong> like trends or volatility, filter noise from time series, or adaptively model changing systems<d-cite key="kalman1965new"></d-cite>.</p> <div class="row mt-3"> <div class="col"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/kalman1-480.webp 480w,/assets/img/kalman1-800.webp 800w,/assets/img/kalman1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/kalman1.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> A schematic layout of the Kalman Filter. </div> <h3 id="mathematical-formulation">Mathematical Formulation</h3> <p>A Kalman Filter models a system as a discrete-time linear dynamical system:</p> <ul> <li> <p><strong>State Equation:</strong> \begin{equation} \label{eq:state-eq} x_{t} = A x_{t-1} + B u_{t} + w_{t}, \quad w_{t} \sim \mathcal{N}(0, Q) \end{equation}</p> </li> <li> <p><strong>Measurement Equation:</strong></p> </li> </ul> <p>\begin{equation} \label{eq:measurment-eq} z_{t} = H x_{t} + v_{t}, \quad v_{t} \sim \mathcal{N}(0, R) \end{equation}</p> <p>Where:</p> <ul> <li>$x_t$: state vector</li> <li>$z_t$: observation vector</li> <li>$A$: state transition matrix</li> <li>$B$: control input matrix</li> <li>$u_t$: control vector</li> <li>$H$: observation matrix</li> <li>$Q$, $R$: process and observation noise covariances</li> </ul> <p>The filter operates in two steps:</p> <ul> <li> <strong>Predict</strong>: estimate the state and covariance at time t given values at $t-1$ with the following equation.</li> </ul> <p>\begin{equation} \label{eq:predict-eq} \hat{x}{t|t-1} = A \hat{x}{t-1|t-1} + B u_t P_{t|t-1} = A P_{t-1|t-1} A^T + Q \end{equation}</p> <ul> <li> <strong>Update</strong>: incorporate new measurements to refine the estimates.</li> </ul> <p>\begin{equation} \label{eq:update-eq} K_t = P_{t|t-1} H^T (H P_{t|t-1} H^T + R)^{-1} \hat{x}{t|t} = \hat{x}{t|t-1} + K_t (z_t - H \hat{x}{t|t-1}) P{t|t} = (I - K_t H) P_{t|t-1} \end{equation}</p> <h3 id="example-estimating-true-price-from-noisy-observations">Example: Estimating True Price from Noisy Observations</h3> <p>Let’s consider a toy example: estimating the true value of a stock price hidden behind noisy observations.</p> <p>Key Assumptions:</p> <ul> <li>The true price follows a <strong>random walk</strong>: $x_t = x_{t-1} + w_t$</li> <li>Observed price is: $z_t = x_t + v_t$</li> </ul> <p>This aligns with Kalman filter structure, where:</p> <ul> <li>$A = 1$, $H = 1$</li> <li>$B = 0$, no control input</li> <li>$Q$ and $R$ are small and fixed</li> </ul> <h3 id="implementation">Implementation</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="sh">'</span><span class="s">classic</span><span class="sh">'</span><span class="p">)</span>


<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">true_price</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">cumsum</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>  <span class="c1"># Random walk
</span><span class="n">observed_price</span> <span class="o">=</span> <span class="n">true_price</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Add noise
</span>
<span class="c1"># Kalman Filter initialization
</span><span class="n">x_est</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>      <span class="c1"># Estimated state
</span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>          <span class="c1"># Estimated error covariance
</span><span class="n">x_est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">observed_price</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">A</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Model Trend
</span><span class="n">H</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Q</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># Trust in model
</span><span class="n">R</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Observation noise variance (Trust in measurements)
</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="c1"># Predict
</span>    <span class="n">x_pred</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">x_est</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">P_pred</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">P</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">A</span> <span class="o">+</span> <span class="n">Q</span>

    <span class="c1"># Update
</span>    <span class="n">K</span> <span class="o">=</span> <span class="n">P_pred</span> <span class="o">*</span> <span class="n">H</span> <span class="o">/</span> <span class="p">(</span><span class="n">H</span> <span class="o">*</span> <span class="n">P_pred</span> <span class="o">*</span> <span class="n">H</span> <span class="o">+</span> <span class="n">R</span><span class="p">)</span>
    <span class="n">x_est</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_pred</span> <span class="o">+</span> <span class="n">K</span> <span class="o">*</span> <span class="p">(</span><span class="n">observed_price</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">H</span> <span class="o">*</span> <span class="n">x_pred</span><span class="p">)</span>
    <span class="n">P</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">K</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span> <span class="o">*</span> <span class="n">P_pred</span>

<span class="c1"># Plotting
</span><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">true_price</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">True Price</span><span class="sh">'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">observed_price</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Observed Price</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x_est</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Kalman Estimate</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Kalman Filter Estimation of Noisy Financial Time Series</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Time</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Price</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

</code></pre></div></div> <div class="row mt-3"> <div class="col"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/kalman_filter_estimation-480.webp 480w,/assets/img/kalman_filter_estimation-800.webp 800w,/assets/img/kalman_filter_estimation-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/kalman_filter_estimation.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Resulting plot. </div> <h3 id="conclusion">Conclusion</h3> <p>Kalman Filters provide a powerful, recursive means of estimating hidden variables from noisy data streams. In financial applications, they serve as tools for smoothing price series, adaptive modeling, and much more. While this example assumes linear dynamics, extensions such as the Extended and Unscented Kalman Filters can handle <strong>nonlinear systems</strong> commonly encountered in real-world scenarios.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/2025-04-01-kalman.bib"></d-bibliography> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Elia Zonta. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>